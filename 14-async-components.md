# **📌 صفحه 14 - کامپوننت‌های ناهمگام (Async Components) در Vue.js**  

در این صفحه، به **مفهوم کامپوننت‌های ناهمگام (Async Components)** در Vue.js می‌پردازیم و روش‌هایی برای **بارگذاری پویا و بهینه‌سازی کامپوننت‌ها** را بررسی خواهیم کرد.  

✅ **مفهوم کامپوننت‌های ناهمگام**  
✅ **چرا از کامپوننت‌های ناهمگام استفاده کنیم؟**  
✅ **بارگذاری پویا و بهینه‌سازی**  
✅ **مثال عملی: بارگذاری کامپوننت‌ها بر اساس نیاز**  

---

## **۱. کامپوننت‌های ناهمگام (Async Components) چیست؟**  

🔹 به‌صورت پیش‌فرض، **Vue.js** هنگام بارگیری یک صفحه، تمامی کامپوننت‌ها را **به‌صورت همزمان و یکجا** بارگیری می‌کند.  
🔹 اگر پروژه شما دارای **کامپوننت‌های سنگین و پیچیده** باشد، این روش باعث **افزایش حجم باندل نهایی و کاهش سرعت لود صفحه** می‌شود.  
🔹 کامپوننت‌های ناهمگام راهکاری برای **بارگیری کامپوننت‌ها فقط در صورت نیاز** ارائه می‌دهند، که باعث **بهبود عملکرد برنامه** می‌شود.  

📌 **مثال ساده از مشکل بارگذاری همه کامپوننت‌ها به صورت همزمان:**  
```vue
<script setup>
import HeavyComponent from './HeavyComponent.vue'
</script>

<template>
  <div>
    <h1>صفحه اصلی</h1>
    <HeavyComponent />
  </div>
</template>
```
✅ در این حالت، `HeavyComponent.vue` بلافاصله هنگام بارگیری صفحه بارگذاری می‌شود، حتی اگر کاربر به آن نیاز نداشته باشد.  

---

## **۲. چرا از کامپوننت‌های ناهمگام استفاده کنیم؟**  

✔ **افزایش سرعت لود صفحه**: تنها کامپوننت‌های مورد نیاز در زمان مناسب بارگیری می‌شوند.  
✔ **کاهش حجم فایل‌های JavaScript**: نیاز نیست تمامی کامپوننت‌ها یکجا بارگیری شوند.  
✔ **بهینه‌سازی عملکرد در پروژه‌های بزرگ**: برای برنامه‌هایی که دارای چندین کامپوننت پیچیده هستند، روش **Lazy Loading** ضروری است.  

---

## **۳. بارگذاری پویا و بهینه‌سازی با `defineAsyncComponent`**  

🔹 Vue.js متدی به نام **`defineAsyncComponent`** را برای بارگیری **کامپوننت‌های ناهمگام** ارائه می‌دهد.  
🔹 این متد به شما این امکان را می‌دهد که **کامپوننت‌ها را فقط در صورت نیاز و به‌صورت Lazy Load بارگیری کنید.**  

📌 **مثال: بارگذاری یک کامپوننت ناهمگام**  
```vue
<script setup>
import { defineAsyncComponent } from 'vue'

// بارگذاری ناهمگام کامپوننت
const AsyncComponent = defineAsyncComponent(() => import('./HeavyComponent.vue'))
</script>

<template>
  <div>
    <h1>صفحه اصلی</h1>
    <AsyncComponent />
  </div>
</template>
```
✅ در این مثال، `HeavyComponent.vue` تنها زمانی که نیاز باشد بارگیری خواهد شد.  

---

## **۴. نمایش لودر (Loading) هنگام بارگذاری کامپوننت**  

🔹 در برخی مواقع، ممکن است **بارگیری کامپوننت ناهمگام زمان‌بر باشد.**  
🔹 می‌توانیم از **یک کامپوننت جایگزین (Loader) در هنگام بارگیری** استفاده کنیم.  

📌 **مثال: نمایش متن "در حال بارگذاری..." هنگام بارگیری کامپوننت**  
```vue
<script setup>
import { defineAsyncComponent } from 'vue'

// بارگذاری ناهمگام همراه با یک لودر و مدیریت خطا
const AsyncComponent = defineAsyncComponent({
  loader: () => import('./HeavyComponent.vue'),
  loadingComponent: {
    template: '<p>⏳ در حال بارگیری...</p>'
  },
  delay: 200 // تأخیر ۲۰۰ میلی‌ثانیه‌ای قبل از نمایش لودر
})
</script>

<template>
  <div>
    <h1>صفحه اصلی</h1>
    <AsyncComponent />
  </div>
</template>
```
✅ حالا اگر `HeavyComponent.vue` بارگیری شود، تا زمان آماده‌شدن آن، پیام **"⏳ در حال بارگیری..."** نمایش داده خواهد شد.  

---

## **۵. مدیریت خطا هنگام بارگیری کامپوننت‌های ناهمگام**  

🔹 در برخی موارد، ممکن است کامپوننت **به دلایل مختلف (مانند قطع شدن اینترنت) بارگیری نشود.**  
🔹 می‌توانیم یک کامپوننت **خطای سفارشی** برای این مواقع نمایش دهیم.  

📌 **مثال: نمایش پیام خطا در صورت شکست در بارگذاری کامپوننت**  
```vue
<script setup>
import { defineAsyncComponent } from 'vue'

const AsyncComponent = defineAsyncComponent({
  loader: () => import('./HeavyComponent.vue'),
  loadingComponent: {
    template: '<p>⏳ در حال بارگیری...</p>'
  },
  errorComponent: {
    template: '<p>❌ خطایی در بارگیری رخ داد.</p>'
  },
  delay: 200,
  timeout: 3000 // زمان انتظار ۳ ثانیه قبل از نمایش خطا
})
</script>

<template>
  <div>
    <h1>صفحه اصلی</h1>
    <AsyncComponent />
  </div>
</template>
```
✅ اگر بعد از **۳ ثانیه** کامپوننت بارگیری نشود، پیام **"❌ خطایی در بارگیری رخ داد."** نمایش داده خواهد شد.  

---

## **📌 جمع‌بندی این صفحه**  

✅ **کامپوننت‌های ناهمگام** برای **بهینه‌سازی بارگذاری و افزایش سرعت صفحه** استفاده می‌شوند.  
✅ با استفاده از `defineAsyncComponent` می‌توان **کامپوننت‌ها را به‌صورت Lazy Load بارگذاری کرد.**  
✅ **نمایش لودر (Loading) و پیام خطا** برای مدیریت بهتر تجربه کاربری استفاده می‌شود.  
✅ این روش برای **بهینه‌سازی پروژه‌های بزرگ Vue.js** توصیه می‌شود.  

---
